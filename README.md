Vagrant kubernetes boilerplate VM
---

Prerequisites:
---
- vagrant
- ansible

Setup
---
`vagrant up` produces 2 vms standing on Debian 11.

After vms are up provision them with ansible:

```console
~$ pwd
/home/jakub/Desktop/vagrant

~$ ansible-playbook -i .vagrant/provisioners/ansible/inventory/vagrant_ansible_inventory kubernetes-setup/main-playbook.yml
```

To access kubernetes dashboard ssh to `k8s-master` (`vagrant ssh k8s-master`) and check kubernetes-dashboard service port:

```console
vagrant@k8s-master:~$ kubectl get svc kubernetes-dashboard -n kubernetes-dashboard -o go-template="{{ (index .spec.ports 0).nodePort }}"
```

The dashboard is accessible via `https://192.168.50.10:SERVICE_PORT` with token that can be generated by following command:

```console
vagrant@k8s-master:~$ echo $(kubectl create token admin-user -n kubernetes-dashboard -o go-template="{{ .status.token }}")
```


---
<sup>When running `vagrant up` for the very first time it's required to run it without `--no-provision` flag - this way minimal provision (ping) will automatically generate `vagrant_ansible_inventory` file, which will be used later with `ansible-playbook` command.</sup>
